<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodigoSH | Setup Wizard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/static/i18n/i18n.js"></script>
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        html.dark body { 
            background: #0a0a0a; 
        }
        
        html:not(.dark) body { 
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); 
            color: #0f172a; 
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            inset: 0;
            z-index: 0;
            opacity: 0.3;
        }

        .bg-gradient {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            animation: float 15s infinite ease-in-out;
        }

        .gradient-1 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(239, 68, 68, 0.4) 0%, transparent 70%);
            top: -150px;
            left: -100px;
        }

        .gradient-2 {
            width: 350px;
            height: 350px;
            background: radial-gradient(circle, rgba(185, 28, 28, 0.3) 0%, transparent 70%);
            bottom: -100px;
            right: -50px;
            animation-delay: 5s;
        }

        /* Setup container */
        .setup-container {
            position: relative;
            z-index: 10;
            width: 100%;
            max-width: 480px;
            margin: 0 1rem;
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .setup-card {
            background: rgba(15, 15, 17, 0.9);
            backdrop-filter: blur(40px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
            box-shadow: 
                0 0 0 1px rgba(255, 255, 255, 0.05),
                0 20px 60px -10px rgba(0, 0, 0, 0.6),
                0 10px 30px -10px rgba(239, 68, 68, 0.5);
            overflow: hidden;
        }

        html:not(.dark) .setup-card {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.06);
            box-shadow: 
                0 0 0 1px rgba(0, 0, 0, 0.03),
                0 20px 60px -10px rgba(0, 0, 0, 0.2),
                0 10px 30px -10px rgba(239, 68, 68, 0.3);
        }

        /* Progress bar */
        .progress-container {
            padding: 2rem 2rem 1rem 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        html:not(.dark) .progress-container {
            border-bottom-color: rgba(0, 0, 0, 0.05);
        }

        .progress-track {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .progress-line {
            position: absolute;
            top: 18px;
            left: 12.5%;
            right: 12.5%;
            height: 2px;
            background: rgba(255, 255, 255, 0.08);
            z-index: 0;
        }

        html:not(.dark) .progress-line {
            background: rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 12px rgba(239, 68, 68, 0.6);
        }

        .step-indicator {
            position: relative;
            z-index: 2;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #0f0f11;
            border: 2px solid rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 700;
            color: #64748b;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 0 4px #0f0f11;
        }

        html:not(.dark) .step-indicator {
            background: #ffffff;
            border-color: rgba(0, 0, 0, 0.1);
            box-shadow: 0 0 0 4px #ffffff;
        }

        .step-indicator.active {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-color: #ef4444;
            color: white;
            box-shadow: 0 0 0 6px rgba(239, 68, 68, 0.12), 0 4px 12px rgba(239, 68, 68, 0.5);
            transform: scale(1.15);
        }

        .step-indicator.completed {
            background: rgba(239, 68, 68, 0.15);
            border-color: #ef4444;
            color: #ef4444;
            transform: scale(1.05);
        }

        .step-indicator.completed::before {
            content: '‚úì';
        }

        .step-wrapper {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 25%;
        }

        .step-label {
            margin-top: 0.5rem;
            font-size: 0.55rem;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: color 0.3s;
            text-align: center;
            max-width: 100px;
            line-height: 1.1;
            word-wrap: break-word;
        }

        .step-label.active {
            color: #ef4444;
        }

        /* Logo & Header */
        .wizard-header {
            text-align: center;
            padding: 1.5rem 2rem;
        }

        .logo {
            width: 52px;
            height: 52px;
            margin: 0 auto 0.75rem;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.625rem;
            font-weight: 900;
            color: white;
            box-shadow: 0 8px 20px -4px rgba(239, 68, 68, 0.6);
        }

        .brand-name {
            font-size: 1.375rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.02em;
        }

        /* Step content */
        .wizard-content {
            padding: 1.5rem 2rem 2rem 2rem;
            min-height: 280px;
        }

        .wizard-step {
            display: none;
        }

        .wizard-step.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        .step-title {
            font-size: 1.125rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .step-desc {
            font-size: 0.8125rem;
            color: #94a3b8;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        html:not(.dark) .step-desc {
            color: #64748b;
        }

        /* Form elements */
        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 700;
            color: #cbd5e1;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        html:not(.dark) .form-label {
            color: #475569;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            background: rgba(255, 255, 255, 0.04);
            border: 1.5px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            font-size: 0.9375rem;
            font-weight: 500;
            color: #ffffff;
            outline: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        html:not(.dark) .form-input {
            background: rgba(0, 0, 0, 0.02);
            border-color: rgba(0, 0, 0, 0.1);
            color: #0f172a;
        }

        .form-input:focus {
            background: rgba(239, 68, 68, 0.05);
            border-color: rgba(239, 68, 68, 0.4);
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.08);
            transform: translateY(-1px);
        }

        .form-input::placeholder {
            color: #64748b;
        }

        /* Language dropdown */
        .language-dropdown {
            position: relative;
            margin-bottom: 1rem;
        }

        .dropdown-selected {
            width: 100%;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.04);
            border: 2px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.9375rem;
            font-weight: 600;
            color: #ffffff;
        }

        html:not(.dark) .dropdown-selected {
            background: rgba(0, 0, 0, 0.02);
            border-color: rgba(0, 0, 0, 0.1);
            color: #0f172a;
        }

        .dropdown-selected:hover {
            border-color: rgba(239, 68, 68, 0.3);
            background: rgba(239, 68, 68, 0.05);
            transform: translateY(-1px);
        }

        .dropdown-selected.open {
            border-color: rgba(239, 68, 68, 0.4);
            background: rgba(239, 68, 68, 0.08);
        }

        .dropdown-arrow {
            font-size: 0.75rem;
            transition: transform 0.3s;
            color: #94a3b8;
        }

        .dropdown-selected.open .dropdown-arrow {
            transform: rotate(180deg);
            color: #ef4444;
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + 0.5rem);
            left: 0;
            right: 0;
            background: rgba(15, 15, 17, 0.98);
            backdrop-filter: blur(40px) saturate(180%);
            border: 1.5px solid rgba(255, 255, 255, 0.1);
            border-radius: 14px;
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05);
            max-height: 360px;
            overflow-y: auto;
            z-index: 100;
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            bottom: auto;
        }

        html:not(.dark) .dropdown-menu {
            background: rgba(255, 255, 255, 0.98);
            border-color: rgba(0, 0, 0, 0.08);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.05);
        }

        .dropdown-menu.open {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .dropdown-menu::-webkit-scrollbar {
            width: 6px;
        }

        .dropdown-menu::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
        }

        .dropdown-menu::-webkit-scrollbar-thumb {
            background: rgba(239, 68, 68, 0.3);
            border-radius: 10px;
        }

        .dropdown-menu::-webkit-scrollbar-thumb:hover {
            background: rgba(239, 68, 68, 0.5);
        }

        .dropdown-option {
            padding: 0.875rem 1.25rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9375rem;
            font-weight: 500;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        html:not(.dark) .dropdown-option {
            border-bottom-color: rgba(0, 0, 0, 0.04);
        }

        .dropdown-option:last-child {
            border-bottom: none;
        }

        .dropdown-option:hover {
            background: rgba(239, 68, 68, 0.08);
            color: #ef4444;
        }

        .dropdown-option.selected {
            background: rgba(239, 68, 68, 0.12);
            color: #ef4444;
            font-weight: 600;
        }

        .dropdown-option .flag {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        /* Avatar upload */
        .avatar-section {
            text-align: center;
            margin-bottom: 1.25rem;
        }

        .avatar-preview {
            width: 80px;
            height: 80px;
            margin: 0 auto 0.875rem;
            border-radius: 50%;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 900;
            color: white;
            box-shadow: 0 12px 24px -6px rgba(239, 68, 68, 0.5);
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .avatar-preview:hover {
            transform: scale(1.05);
        }

        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-label {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1.5px solid rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            color: #ef4444;
            font-size: 0.8125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .avatar-label:hover {
            background: rgba(239, 68, 68, 0.15);
            transform: translateY(-1px);
        }

        .avatar-input {
            display: none;
        }

        /* Theme selector */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.875rem;
            margin-bottom: 1rem;
        }

        .theme-card {
            padding: 1.25rem;
            background: rgba(255, 255, 255, 0.04);
            border: 2px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        html:not(.dark) .theme-card {
            background: rgba(0, 0, 0, 0.02);
            border-color: rgba(0, 0, 0, 0.08);
        }

        .theme-card:hover {
            border-color: rgba(239, 68, 68, 0.3);
            background: rgba(239, 68, 68, 0.05);
            transform: translateY(-2px);
        }

        .theme-card.selected {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.12);
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.08);
        }

        .theme-icon {
            width: 40px;
            height: 40px;
            margin: 0 auto 0.625rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: transform 0.3s;
        }

        .theme-card.selected .theme-icon {
            transform: scale(1.1);
        }

        .theme-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: #cbd5e1;
        }

        html:not(.dark) .theme-name {
            color: #475569;
        }

        .theme-card.selected .theme-name {
            color: #ef4444;
        }

        /* Summary */
        .summary-grid {
            display: grid;
            gap: 0.875rem;
        }

        .summary-item {
            padding: 1rem;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
        }

        html:not(.dark) .summary-item {
            background: rgba(0, 0, 0, 0.02);
            border-color: rgba(0, 0, 0, 0.06);
        }

        .summary-label {
            font-size: 0.75rem;
            font-weight: 700;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.375rem;
        }

        .summary-value {
            font-size: 0.9375rem;
            font-weight: 600;
            color: #ffffff;
        }

        html:not(.dark) .summary-value {
            color: #0f172a;
        }

        /* Buttons */
        .wizard-actions {
            display: flex;
            gap: 0.75rem;
            padding: 0 2rem 2rem 2rem;
        }

        .btn {
            flex: 1;
            padding: 0.875rem 1.25rem;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            border: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-back {
            background: rgba(255, 255, 255, 0.05);
            border: 1.5px solid rgba(255, 255, 255, 0.1);
            color: #cbd5e1;
        }

        html:not(.dark) .btn-back {
            background: rgba(0, 0, 0, 0.03);
            border-color: rgba(0, 0, 0, 0.1);
            color: #475569;
        }

        .btn-back:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }

        .btn-next {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 6px 20px -4px rgba(239, 68, 68, 0.5);
        }

        .btn-next:hover {
            box-shadow: 0 8px 24px -4px rgba(239, 68, 68, 0.6);
            transform: translateY(-2px);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Error message */
        .error-alert {
            display: none;
            padding: 0.875rem 1rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1.5px solid rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            color: #fca5a5;
            font-size: 0.8125rem;
            margin-bottom: 1rem;
            animation: fadeIn 0.3s;
        }

        html:not(.dark) .error-alert {
            color: #dc2626;
        }

        .error-alert.show {
            display: block;
        }

        /* Password toggle */
        .input-wrapper {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            padding: 0.5rem;
            transition: color 0.2s;
        }

        .password-toggle:hover {
            color: #ef4444;
        }

        @media (max-width: 480px) {
            .setup-container {
                margin: 0 0.75rem;
            }
            
            .wizard-content {
                padding: 1.25rem 1.5rem 1.5rem 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Animated background -->
    <div class="bg-animation">
        <div class="bg-gradient gradient-1"></div>
        <div class="bg-gradient gradient-2"></div>
    </div>

    <!-- Setup wizard -->
    <div class="setup-container">
        <div class="setup-card">
            <!-- Progress bar -->
            <div class="progress-container">
                <div class="progress-track">
                    <div class="progress-line">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="step-wrapper">
                        <div class="step-indicator active" data-step="1">1</div>
                        <div class="step-label active" data-i18n="setup.stepLanguage">Language</div>
                    </div>
                    <div class="step-wrapper">
                        <div class="step-indicator" data-step="2">2</div>
                        <div class="step-label" data-i18n="setup.stepAccount">Account</div>
                    </div>
                    <div class="step-wrapper">
                        <div class="step-indicator" data-step="3">3</div>
                        <div class="step-label" data-i18n="setup.stepCustomize">Customize</div>
                    </div>
                    <div class="step-wrapper">
                        <div class="step-indicator" data-step="4">4</div>
                        <div class="step-label" data-i18n="setup.stepComplete">Complete</div>
                    </div>
                </div>
            </div>

            <!-- Header -->
            <div class="wizard-header">
                <div class="logo">K</div>
                <div class="brand-name">CodigoSH</div>
            </div>

            <!-- Error message -->
            <div style="padding: 0 2rem;">
                <div class="error-alert" id="errorAlert"></div>
            </div>

            <!-- Wizard form -->
            <form id="setupForm" method="POST" action="/setup" enctype="multipart/form-data">
                <!-- Content area -->
                <div class="wizard-content">
                    <!-- Step 1: Language -->
                    <div class="wizard-step active" data-step="1">
                        <h2 class="step-title" data-i18n="setup.chooseLanguage">üåç Choose Your Language</h2>
                        <p class="step-desc" data-i18n="setup.languageDesc">This will be used throughout the application</p>
                        <div class="form-group">
                            <div class="language-dropdown">
                                <div class="dropdown-selected" id="dropdownSelected">
                                    <span id="selectedLangText">üá∫üá∏ English</span>
                                    <span class="dropdown-arrow">‚ñº</span>
                                </div>
                                <div class="dropdown-menu" id="dropdownMenu">
                                    <div class="dropdown-option selected" data-lang="en" data-text="üá∫üá∏ English">
                                        <span class="flag">üá∫üá∏</span> English
                                    </div>
                                    <div class="dropdown-option" data-lang="es" data-text="üá™üá∏ Espa√±ol">
                                        <span class="flag">üá™üá∏</span> Espa√±ol
                                    </div>
                                    <div class="dropdown-option" data-lang="fr" data-text="üá´üá∑ Fran√ßais">
                                        <span class="flag">üá´üá∑</span> Fran√ßais
                                    </div>
                                    <div class="dropdown-option" data-lang="de" data-text="üá©üá™ Deutsch">
                                        <span class="flag">üá©üá™</span> Deutsch
                                    </div>
                                    <div class="dropdown-option" data-lang="it" data-text="üáÆüáπ Italiano">
                                        <span class="flag">üáÆüáπ</span> Italiano
                                    </div>
                                    <div class="dropdown-option" data-lang="pt" data-text="üáµüáπ Portugu√™s">
                                        <span class="flag">üáµüáπ</span> Portugu√™s
                                    </div>
                                    <div class="dropdown-option" data-lang="ru" data-text="üá∑üá∫ –†—É—Å—Å–∫–∏–π">
                                        <span class="flag">üá∑üá∫</span> –†—É—Å—Å–∫–∏–π
                                    </div>
                                    <div class="dropdown-option" data-lang="zh" data-text="üá®üá≥ ‰∏≠Êñá">
                                        <span class="flag">üá®üá≥</span> ‰∏≠Êñá (Chinese)
                                    </div>
                                    <div class="dropdown-option" data-lang="ja" data-text="üáØüáµ Êó•Êú¨Ë™û">
                                        <span class="flag">üáØüáµ</span> Êó•Êú¨Ë™û (Japanese)
                                    </div>
                                    <div class="dropdown-option" data-lang="ko" data-text="üá∞üá∑ ÌïúÍµ≠Ïñ¥">
                                        <span class="flag">üá∞üá∑</span> ÌïúÍµ≠Ïñ¥ (Korean)
                                    </div>
                                    <div class="dropdown-option" data-lang="ar" data-text="üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©">
                                        <span class="flag">üá∏üá¶</span> ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)
                                    </div>
                                    <div class="dropdown-option" data-lang="hi" data-text="üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä">
                                        <span class="flag">üáÆüá≥</span> ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)
                                    </div>
                                    <div class="dropdown-option" data-lang="nl" data-text="üá≥üá± Nederlands">
                                        <span class="flag">üá≥üá±</span> Nederlands (Dutch)
                                    </div>
                                    <div class="dropdown-option" data-lang="sv" data-text="üá∏üá™ Svenska">
                                        <span class="flag">üá∏üá™</span> Svenska (Swedish)
                                    </div>
                                    <div class="dropdown-option" data-lang="pl" data-text="üáµüá± Polski">
                                        <span class="flag">üáµüá±</span> Polski (Polish)
                                    </div>
                                    <div class="dropdown-option" data-lang="tr" data-text="üáπüá∑ T√ºrk√ße">
                                        <span class="flag">üáπüá∑</span> T√ºrk√ße (Turkish)
                                    </div>
                                    <div class="dropdown-option" data-lang="vi" data-text="üáªüá≥ Ti·∫øng Vi·ªát">
                                        <span class="flag">üáªüá≥</span> Ti·∫øng Vi·ªát (Vietnamese)
                                    </div>
                                    <div class="dropdown-option" data-lang="th" data-text="üáπüá≠ ‡πÑ‡∏ó‡∏¢">
                                        <span class="flag">üáπüá≠</span> ‡πÑ‡∏ó‡∏¢ (Thai)
                                    </div>
                                    <div class="dropdown-option" data-lang="id" data-text="üáÆüá© Bahasa">
                                        <span class="flag">üáÆüá©</span> Bahasa Indonesia
                                    </div>
                                    <div class="dropdown-option" data-lang="el" data-text="üá¨üá∑ ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨">
                                        <span class="flag">üá¨üá∑</span> ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨ (Greek)
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" name="language" id="languageInput" value="en">
                        </div>
                    </div>

                    <!-- Step 2: Account -->
                    <div class="wizard-step" data-step="2">
                        <h2 class="step-title" data-i18n="setup.createAccount">üë§ Create Admin Account</h2>
                        <p class="step-desc" data-i18n="setup.accountDesc">Set up your administrator credentials</p>
                        <div class="form-group">
                            <label class="form-label" data-i18n="setup.username">Username</label>
                            <input type="text" name="username" id="username" class="form-input" 
                                   data-i18n-placeholder="setup.usernamePlaceholder" placeholder="Choose a username" required minlength="3">
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="setup.password">Password</label>
                            <div class="input-wrapper">
                                <input type="password" name="password" id="password" class="form-input" 
                                       data-i18n-placeholder="setup.passwordPlaceholder" placeholder="Create a secure password" required minlength="6">
                                <button type="button" class="password-toggle">üëÅÔ∏è</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" data-i18n="setup.confirmPassword">Confirm Password</label>
                            <div class="input-wrapper">
                                <input type="password" id="confirmPassword" class="form-input" 
                                       data-i18n-placeholder="setup.confirmPasswordPlaceholder" placeholder="Confirm your password" required minlength="6">
                                <button type="button" class="password-toggle">üëÅÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Customize -->
                    <div class="wizard-step" data-step="3">
                        <h2 class="step-title" data-i18n="setup.personalize">üé® Personalize</h2>
                        <p class="step-desc" data-i18n="setup.personalizeDesc">Add your avatar and choose your theme</p>
                        
                        <div class="avatar-section">
                            <div class="avatar-preview" id="avatarPreview">
                                <span id="avatarInitial">K</span>
                            </div>
                            <label class="avatar-label" for="avatarInput" data-i18n="setup.uploadAvatar">
                                üì∑ Upload Avatar (Optional)
                            </label>
                            <input type="file" id="avatarInput" name="avatar" class="avatar-input" 
                                   accept="image/*">
                        </div>

                        <div class="form-group">
                            <label class="form-label" data-i18n="setup.chooseTheme">Choose Theme</label>
                            <div class="theme-grid">
                                <div class="theme-card selected" data-theme="dark">
                                    <div class="theme-icon">üåô</div>
                                    <div class="theme-name" data-i18n="setup.themeDark">Dark</div>
                                </div>
                                <div class="theme-card" data-theme="light">
                                    <div class="theme-icon">‚òÄÔ∏è</div>
                                    <div class="theme-name" data-i18n="setup.themeLight">Light</div>
                                </div>
                            </div>
                            <input type="hidden" name="theme" id="themeInput" value="dark">
                        </div>
                    </div>

                    <!-- Step 4: Summary -->
                    <div class="wizard-step" data-step="4">
                        <h2 class="step-title" data-i18n="setup.allSet">‚ú® All Set!</h2>
                        <p class="step-desc" data-i18n="setup.reviewSetup">Review your setup and complete the installation</p>
                        
                        <div class="summary-grid">
                            <div class="summary-item">
                                <div class="summary-label" data-i18n="setup.language">Language</div>
                                <div class="summary-value" id="summaryLanguage">English</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Username</div>
                                <div class="summary-value" id="summaryUsername">-</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Theme</div>
                                <div class="summary-value" id="summaryTheme">Dark</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Avatar</div>
                                <div class="summary-value" id="summaryAvatar">Default</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation buttons -->
                <div class="wizard-actions">
                    <button type="button" class="btn btn-back" id="backBtn" style="display:none;">
                        <span data-i18n="setup.back">‚Üê Back</span>
                    </button>
                    <button type="button" class="btn btn-next" id="nextBtn">
                        <span data-i18n="setup.next">Next ‚Üí</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let currentStep = 1;
            const totalSteps = 4;
            const languageLabels = {
                en: 'English', es: 'Espa√±ol', fr: 'Fran√ßais', de: 'Deutsch',
                it: 'Italiano', pt: 'Portugu√™s', ru: '–†—É—Å—Å–∫–∏–π', zh: '‰∏≠Êñá',
                ja: 'Êó•Êú¨Ë™û', ko: 'ÌïúÍµ≠Ïñ¥', ar: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', hi: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä',
                nl: 'Nederlands', sv: 'Svenska', pl: 'Polski', tr: 'T√ºrk√ße',
                vi: 'Ti·∫øng Vi·ªát', th: '‡πÑ‡∏ó‡∏¢', id: 'Bahasa', el: 'ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨'
            };

            // Language dropdown
            const dropdownSelected = document.getElementById('dropdownSelected');
            const dropdownMenu = document.getElementById('dropdownMenu');
            const selectedLangText = document.getElementById('selectedLangText');
            const languageInput = document.getElementById('languageInput');
            
            if (dropdownSelected && dropdownMenu) {
                dropdownSelected.addEventListener('click', function(e) {
                    e.stopPropagation();
                    dropdownMenu.classList.toggle('open');
                    dropdownSelected.classList.toggle('open');
                    
                    // Check if dropdown fits below, if not open upwards
                    if (dropdownMenu.classList.contains('open')) {
                        setTimeout(() => {
                            const rect = dropdownSelected.getBoundingClientRect();
                            const dropdownHeight = dropdownMenu.offsetHeight;
                            const spaceBelow = window.innerHeight - rect.bottom;
                            
                            if (spaceBelow < dropdownHeight + 20) {
                                dropdownMenu.style.top = 'auto';
                                dropdownMenu.style.bottom = 'calc(100% + 0.5rem)';
                            } else {
                                dropdownMenu.style.top = 'calc(100% + 0.5rem)';
                                dropdownMenu.style.bottom = 'auto';
                            }
                        }, 0);
                    }
                });

                document.querySelectorAll('.dropdown-option').forEach(option => {
                    option.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const lang = this.dataset.lang;
                        const text = this.dataset.text;
                        
                        selectedLangText.textContent = text;
                        languageInput.value = lang;
                        
                        document.querySelectorAll('.dropdown-option').forEach(opt => opt.classList.remove('selected'));
                        this.classList.add('selected');
                        
                        dropdownMenu.classList.remove('open');
                        dropdownSelected.classList.remove('open');
                        
                        // Update language immediately
                        if (window.i18n) {
                            localStorage.setItem('selectedLanguage', lang);
                            window.i18n.currentLanguage = lang;
                            window.i18n.loadLanguage(lang).then(() => {
                                window.i18n.updatePageLanguage();
                            });
                        }
                    });
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!dropdownSelected.contains(e.target) && !dropdownMenu.contains(e.target)) {
                        dropdownMenu.classList.remove('open');
                        dropdownSelected.classList.remove('open');
                    }
                });
            }

        // Theme selection
        document.querySelectorAll('.theme-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                document.getElementById('themeInput').value = this.dataset.theme;
            });
        });

        // Avatar preview
        function previewAvatar(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('avatarPreview');
                    preview.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Password toggle
        function togglePassword(fieldId) {
            const field = document.getElementById(fieldId);
            field.type = field.type === 'password' ? 'text' : 'password';
        }
        
        // Add event listeners for password toggles
        document.querySelectorAll('.password-toggle').forEach((btn, index) => {
            btn.addEventListener('click', function() {
                const input = this.previousElementSibling;
                if (input) {
                    input.type = input.type === 'password' ? 'text' : 'password';
                }
            });
        });

        // Avatar preview
        function previewAvatar(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('avatarPreview');
                    preview.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                };
                reader.readAsDataURL(file);
            }
        }
        
        // Avatar input handler
        const avatarInput = document.getElementById('avatarInput');
        if (avatarInput) {
            avatarInput.addEventListener('change', previewAvatar);
        }
        
        // Avatar preview click handler
        const avatarPreview = document.getElementById('avatarPreview');
        if (avatarPreview) {
            avatarPreview.addEventListener('click', function() {
                avatarInput.click();
            });
        }
        document.getElementById('username').addEventListener('input', function() {
            const initial = this.value.charAt(0).toUpperCase() || 'K';
            const avatarInitial = document.getElementById('avatarInitial');
            if (avatarInitial) {
                avatarInitial.textContent = initial;
            }
        });

        // Navigation
        function updateProgress() {
            const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Update step indicators
            document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                indicator.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    indicator.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    indicator.classList.add('active');
                }
            });

            // Update step labels
            document.querySelectorAll('.step-label').forEach((label, index) => {
                label.classList.toggle('active', index + 1 === currentStep);
            });

            // Show/hide steps
            document.querySelectorAll('.wizard-step').forEach((step, index) => {
                step.classList.toggle('active', index + 1 === currentStep);
            });

            // Update buttons
            document.getElementById('backBtn').style.display = currentStep === 1 ? 'none' : 'block';
            const nextBtn = document.getElementById('nextBtn');
            const nextBtnText = nextBtn.querySelector('span');
            if (currentStep === totalSteps) {
                nextBtnText.setAttribute('data-i18n', 'setup.complete');
                nextBtnText.textContent = window.i18n ? window.i18n.t('setup.complete') : 'Complete Setup ‚úì';
            } else {
                nextBtnText.setAttribute('data-i18n', 'setup.next');
                nextBtnText.textContent = window.i18n ? window.i18n.t('setup.next') : 'Next ‚Üí';
            }
        }

        function validateStep() {
            const errorAlert = document.getElementById('errorAlert');
            errorAlert.classList.remove('show');

            if (currentStep === 2) {
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (username.length < 3) {
                    errorAlert.textContent = 'Username must be at least 3 characters';
                    errorAlert.classList.add('show');
                    return false;
                }

                if (password.length < 6) {
                    errorAlert.textContent = 'Password must be at least 6 characters';
                    errorAlert.classList.add('show');
                    return false;
                }

                if (password !== confirmPassword) {
                    errorAlert.textContent = 'Passwords do not match';
                    errorAlert.classList.add('show');
                    return false;
                }
            }

            return true;
        }

        function updateSummary() {
            const lang = document.getElementById('languageInput').value;
            document.getElementById('summaryLanguage').textContent = languageLabels[lang] || lang;
            document.getElementById('summaryUsername').textContent = document.getElementById('username').value || '-';
            document.getElementById('summaryTheme').textContent = document.getElementById('themeInput').value === 'dark' ? 'Dark' : 'Light';
            document.getElementById('summaryAvatar').textContent = document.getElementById('avatarInput').files.length > 0 ? 'Custom' : 'Default';
        }

        function nextStep() {
            if (!validateStep()) return;

            if (currentStep === totalSteps) {
                document.getElementById('setupForm').submit();
                return;
            }

            if (currentStep === 3) {
                updateSummary();
            }

            currentStep++;
            updateProgress();
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateProgress();
            }
        }

        // Navigation button handlers
        document.getElementById('nextBtn').addEventListener('click', nextStep);
        document.getElementById('backBtn').addEventListener('click', previousStep);

        // Initialize
        updateProgress();

        // Initialize i18n (make it global for language switching)
        window.i18n = new I18n();
        window.i18n.loadLanguage().then(() => {
            window.i18n.updatePageLanguage();
        });
        
        }); // End DOMContentLoaded
    </script>
</body>
</html>
