```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  FLUJO DE ACTUALIZACIONES CODIGOSH v0.1.3                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1๏ธโฃ  USUARIO INICIA LA ACTUALIZACIรN                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  Dashboard                                                                   โ
โ  โโ Avatar con badge ๐ด "Actualizaciรณn disponible"                         โ
โ  โโ Click en "Actualizaciรณn disponible"                                     โ
โ  โโ Modal muestra:                                                           โ
โ     โโ Versiรณn actual: 0.1.3-Beta                                          โ
โ     โโ Nueva versiรณn: 0.1.4-Beta                                           โ
โ     โโ Changelog                                                             โ
โ     โโ Botรณn "Actualizar" (rojo)                                            โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2๏ธโฃ  FRONTEND ENVรA SOLICITUD                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  fetch('/perform-update', {method: 'POST'})                                โ
โ     โโ Botรณn cambia a "Compilando..."                                      โ
โ     โโ Botรณn deshabilitado                                                  โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3๏ธโฃ  BACKEND: VERIFICAR ACTUALIZACIรN                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  HandlePerformUpdate()                                                       โ
โ  โโ Verificar que hay actualizaciรณn disponible                             โ
โ  โโ Obtener ruta del ejecutable: /opt/CodigoSH/codigosH                   โ
โ  โโ Crear directorio temporal: /tmp/codigosh-update/                      โ
โ                                                                              โ
โ  Log: "Iniciando compilaciรณn de actualizaciรณn..."                          โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 4๏ธโฃ  BACKEND: CREAR Y EJECUTAR SCRIPT DE ACTUALIZACIรN                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  /tmp/update_codigosh_build.sh (ejecutado en background)                  โ
โ                                                                              โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ  โ #!/bin/bash                                                         โ  โ
โ  โ set -e                                                              โ  โ
โ  โ                                                                     โ  โ
โ  โ [~0-5s] git clone --depth=1 --branch main \                        โ  โ
โ  โ         https://github.com/kiwinh0/CodigoSH.git /tmp/.../repo      โ  โ
โ  โ         โ Descarga cรณdigo fuente del repositorio                   โ  โ
โ  โ                                                                     โ  โ
โ  โ [~5-10s] cd repo && go mod download                                โ  โ
โ  โ          โ Descarga dependencias Go (cache posterior)              โ  โ
โ  โ                                                                     โ  โ
โ  โ [~10-40s] CGO_ENABLED=1 go build -o codigosH \                     โ  โ
โ  โ           ./cmd/codigosH/main.go                                   โ  โ
โ  โ           โ Compila binario para arquitectura local (Linux AMD64)  โ  โ
โ  โ                                                                     โ  โ
โ  โ [~40-45s] cp /opt/CodigoSH/codigosH \                              โ  โ
โ  โ           /opt/CodigoSH/codigosH.backup                            โ  โ
โ  โ           โ Crea backup del binario actual                         โ  โ
โ  โ                                                                     โ  โ
โ  โ [~45-50s] cp codigosH /opt/CodigoSH/codigosH                       โ  โ
โ  โ           โ Reemplaza binario con versiรณn nueva                    โ  โ
โ  โ                                                                     โ  โ
โ  โ [~50-55s] systemctl restart codigosH                               โ  โ
โ  โ           โ Reinicia servicio systemd                              โ  โ
โ  โ                                                                     โ  โ
โ  โ [~55-60s] Limpiar /tmp/codigosh-update/                            โ  โ
โ  โ           โ Elimina directorios temporales                         โ  โ
โ  โ                                                                     โ  โ
โ  โ Logs: /tmp/codigosh_update.log                                     โ  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                              โ
โ  Tiempo total: ~30-60 segundos (depende del servidor y conexiรณn internet) โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 5๏ธโฃ  BACKEND: RESPUESTA AL FRONTEND                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  {                                                                           โ
โ    "success": true,                                                         โ
โ    "message": "Actualizaciรณn iniciada. Compilando desde cรณdigo fuente...   โ
โ                El servicio se reiniciarรก automรกticamente."                 โ
โ  }                                                                           โ
โ                                                                              โ
โ  โ Frontend recibe respuesta inmediatamente (script corre en background)  โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 6๏ธโฃ  FRONTEND: MOSTRAR CONFIRMACIรN                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  โโ Botรณn muestra "โ Actualizaciรณn iniciada"                              โ
โ  โโ Mostrar alert: "El servicio se estรก reiniciando con la nueva versiรณn" โ
โ  โ  "Esto puede tomar 30-60 segundos. Por favor, espera..."              โ
โ  โโ Esperar 2 segundos                                                     โ
โ                                                                              โ
โ  Window.location.reload() โ Recargar pรกgina                               โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 7๏ธโฃ  USUARIO: ESPERAR A QUE SERVICIO SE REINICIE                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  โณ Esperar 30-60 segundos mientras se compila en el servidor              โ
โ                                                                              โ
โ  Que estรก pasando (en paralelo):                                           โ
โ  โโ Compilaciรณn en el servidor: go build (~20-40 segundos)               โ
โ  โโ Reemplazo de binario: ~2 segundos                                    โ
โ  โโ Reinicio de servicio: ~5-10 segundos                                 โ
โ  โโ Total: ~30-60 segundos                                               โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 8๏ธโฃ  SERVICIO: REINICIADO CON NUEVA VERSIรN                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  Archivo: /opt/CodigoSH/codigosH (reemplazado)                            โ
โ  Versiรณn: 0.1.4-Beta (nueva)                                              โ
โ  Estado: โ Ejecutรกndose                                                   โ
โ                                                                              โ
โ  Backup guardado: /opt/CodigoSH/codigosH.backup (v0.1.3-Beta)            โ
โ  Logs: /tmp/codigosh_update.log (completo)                                โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 9๏ธโฃ  USUARIO: VER NUEVA VERSIรN                                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                              โ
โ  โ Pรกgina recargada                                                       โ
โ  โ Servidor responde con nueva versiรณn                                   โ
โ  โ Badge rojo desaparece (no hay actualizaciones disponibles)             โ
โ  โ Click en usuario โ "Acerca de" muestra: 0.1.4-Beta                    โ
โ                                                                              โ
โ  ๐ ยกACTUALIZACIรN COMPLETADA EXITOSAMENTE!                               โ
โ                                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              ARCHIVOS INVOLUCRADOS
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Frontend (HTML/JavaScript)
โโ web/templates/dashboard.html
โ  โโ performUpdate() โ fetch('/perform-update')
โ  โโ openUpdateModal() โ Mostrar modal
โ  โโ populateUpdateModal() โ Llenar informaciรณn
โ
Backend (Go)
โโ internal/handlers/updates.go
โ  โโ CheckForUpdates() โ Verificar GitHub
โ  โโ HandleCheckUpdates() โ Endpoint /check-updates
โ  โโ HandlePerformUpdate() โ Endpoint /perform-update
โ                            โโ Crear script y ejecutarlo
โ
Scripts (Bash)
โโ /tmp/update_codigosh_build.sh (generado dinรกmicamente)
โ  โโ Compilaciรณn, instalaciรณn, reinicio
โ
Logs
โโ /tmp/codigosh_update.log โ Detalles de compilaciรณn
โโ systemd journal โ Logs de reinicio del servicio
โ
Binarios
โโ /opt/CodigoSH/codigosH โ Nuevo binario (reemplazado)
โโ /opt/CodigoSH/codigosH.backup โ Binario anterior (respaldo)


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              REQUISITOS DEL SISTEMA
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ Git                    โ Clonar repositorio
โ Go 1.24+              โ Compilar cรณdigo fuente
โ build-essential        โ gcc, make
โ Acceso a internet      โ Conectar a GitHub
โ 500MB espacio /tmp     โ Compilaciรณn temporal
โ Permisos sudo/systemd  โ Reiniciar servicio

Nota: Todos estos requisitos ya estรกn en install.sh


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              SOLUCIรN DE PROBLEMAS
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ "Error: Binario no disponible para descargar"
   โ Significa que el backend no encontrรณ la actualizaciรณn
   โ Revisar que exista nuevo tag en GitHub

โ "Error iniciando la actualizaciรณn"
   โ Revisar: sudo journalctl -u codigosH
   โ Revisar: cat /tmp/codigosh_update.log

โ "Error en compilaciรณn"
   โ Git no estรก instalado: sudo apt-get install git
   โ Go no estรก instalado: sudo apt-get install golang-1.24

โ "Compilaciรณn muy lenta"
   โ Normal: primera vez tarda 60+ segundos (descarga mรณdulos)
   โ Posteriores son mรกs rรกpidas (~30-40s)

โ "Servicio no reinicia"
   โ Revisar: systemctl status codigosH
   โ Reiniciar manual: sudo systemctl restart codigosH

โ "ยฟCรณmo revierto a versiรณn anterior?"
   โ cp /opt/CodigoSH/codigosH.backup /opt/CodigoSH/codigosH
   โ sudo systemctl restart codigosH


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## Monitoreo en Tiempo Real

Durante la actualizaciรณn, abra mรบltiples terminales:

```bash
# Terminal 1: Ver detalles de compilaciรณn
tail -f /tmp/codigosh_update.log

# Terminal 2: Ver logs del servicio
sudo journalctl -u codigosH -f

# Terminal 3: Monitorear binario
watch -n 1 'ls -lah /opt/CodigoSH/codigosh*'

# Terminal 4: Ver proceso compilador
watch -n 1 'ps aux | grep -E "go|git|codigosH"'
```

Cada actualizaciรณn dejarรก un registro completo en `/tmp/codigosh_update.log` para debugging posterior.
